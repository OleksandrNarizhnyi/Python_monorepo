### üîπ **MongoDB `$bucket` ‚Äî –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º**  

**`$bucket`** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ **–≥—Ä—É–ø–ø—ã (–∫–æ—Ä–∑–∏–Ω—ã) –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º –∑–Ω–∞—á–µ–Ω–∏–π**.  
–ö–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è **–∫–ª—é—á** ‚Äî –≥—Ä–∞–Ω–∏—Ü—ã –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é.  

---

### ‚úÖ **–°–∏–Ω—Ç–∞–∫—Å–∏—Å**  
```js
{ 
  $bucket: {
    groupBy: "$<–ø–æ–ª–µ>",   // –ü–æ–ª–µ, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –≥—Ä—É–ø–ø–∏—Ä—É–µ–º
    boundaries: [0, 10, 20, 30], // –ì—Ä–∞–Ω–∏—Ü—ã –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ (–ª–µ–≤–∞—è –≤–∫–ª—é—á–µ–Ω–∞, –ø—Ä–∞–≤–∞—è –Ω–µ—Ç)
    default: "Other", // –ì—Ä—É–ø–ø–∞ –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
    output: { count: { $sum: 1 } } // (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  } 
}
```
üîπ –ö–∞–∂–¥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ **–ø–µ—Ä–≤—É—é –≥—Ä–∞–Ω–∏—Ü—É, –≥–¥–µ –æ–Ω–æ –º–µ–Ω—å—à–µ –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã**.  

---

### ‚úÖ **–ü—Ä–∏–º–µ—Ä: –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ª—é–¥–µ–π –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–º**  
üìå **–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**  
```js
db.people.insertMany([
  { name: "Alice", age: 23 },
  { name: "Bob", age: 17 },
  { name: "Charlie", age: 35 },
  { name: "David", age: 41 },
  { name: "Eve", age: 12 }
])
```
üìå **–ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É (0-18, 18-30, 30-50)**  
```js
db.people.aggregate([
  { 
    $bucket: {
      groupBy: "$age",
      boundaries: [0, 18, 30, 50], 
      default: "50+",
      output: { count: { $sum: 1 } }
    }
  }
])
```
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**  
```js
{ "_id": 0, "count": 2 }   // (0-18): Bob (17), Eve (12)
{ "_id": 18, "count": 1 }  // (18-30): Alice (23)
{ "_id": 30, "count": 1 }  // (30-50): Charlie (35)
{ "_id": "50+", "count": 1 } // (50+): David (41)
```
üîπ **–ö–ª—é—á `_id`** ‚Äî —ç—Ç–æ –Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞.  

---

### ‚úÖ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ (`output`)**  
–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç:  
```js
db.people.aggregate([
  { 
    $bucket: {
      groupBy: "$age",
      boundaries: [0, 18, 30, 50],
      default: "50+",
      output: {
        count: { $sum: 1 },
        avgAge: { $avg: "$age" }
      }
    }
  }
])
```
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç —Å `avgAge`**  
```js
{ "_id": 0, "count": 2, "avgAge": 14.5 }
{ "_id": 18, "count": 1, "avgAge": 23 }
{ "_id": 30, "count": 1, "avgAge": 35 }
{ "_id": "50+", "count": 1, "avgAge": 41 }
```



-----------------------------------------------------------------------------



### üîπ **MongoDB `$push` ‚Äî –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –º–∞—Å—Å–∏–≤**  

–û–ø–µ—Ä–∞—Ç–æ—Ä **`$push`** –ø–æ–∑–≤–æ–ª—è–µ—Ç **—Å–æ–±–∏—Ä–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ –º–∞—Å—Å–∏–≤** –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏.

---

## ‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ `$group` (–ê–≥—Ä–µ–≥–∞—Ü–∏—è)**  

üìå **–ü—Ä–∏–º–µ—Ä: –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –∑–∞–∫–∞–∑—ã –ø–æ –∫–ª–∏–µ–Ω—Ç—É –∏ —Å–æ–±–∏—Ä–∞–µ–º –∏—Ö –≤ –º–∞—Å—Å–∏–≤**  

**–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**  
```js
db.orders.insertMany([
  { _id: 1, customer: "Alice", product: "Laptop" },
  { _id: 2, customer: "Alice", product: "Mouse" },
  { _id: 3, customer: "Bob", product: "Keyboard" }
])
```
üìå **–ó–∞–ø—Ä–æ—Å: —Å–æ–±–∏—Ä–∞–µ–º `product` –≤ –º–∞—Å—Å–∏–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ `customer`**  
```js
db.orders.aggregate([
  { 
    $group: { 
      _id: "$customer", 
      products: { $push: "$product" } 
    }
  }
])
```
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**  
```js
{ "_id": "Alice", "products": ["Laptop", "Mouse"] }
{ "_id": "Bob", "products": ["Keyboard"] }
```
üîπ **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç `$push`?**  
- –ë–µ—Ä—ë—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –ø–æ–ª—è (`"$product"`)  
- –î–æ–±–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ –º–∞—Å—Å–∏–≤ `products`  



-----------------------------------------------------------------------------



### ‚úÖ **1. `$set`** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö

- **–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å**: –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª—è –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ.
- **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**: 
  - –ï—Å–ª–∏ –ø–æ–ª–µ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ–Ω–æ **–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è** –∑–Ω–∞—á–µ–Ω–∏–µ–º, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã –∑–∞–¥–∞–µ—Ç–µ.
  - –ï—Å–ª–∏ –ø–æ–ª—è –Ω–µ—Ç, –æ–Ω–æ **–¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è** –≤ –¥–æ–∫—É–º–µ–Ω—Ç.
  
### üìå **–ü—Ä–∏–º–µ—Ä**:
```js
db.collection.aggregate([
  {
    $set: {
      total: { $add: ["$price", "$tax"] },  // –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª–µ `total`
      status: "active"                     // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ `status`
    }
  }
])
```
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–ª–µ `total`, –∞ —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `status` —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º "active".

---

### ‚úÖ **2. `$unset`** ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

- **–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å**: –£–¥–∞–ª–∏—Ç—å –æ–¥–Ω–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª–µ–π –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞.
- **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**: –£–¥–∞–ª—è–µ—Ç **–ø–æ–ª–µ** –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –Ω–æ –Ω–µ –º–µ–Ω—è–µ—Ç —Å–∞–º—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **—Ç–æ–ª—å–∫–æ –Ω–∞ —ç—Ç–∞–ø–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏**, –∏ —Å–∞–º–æ –ø–æ–ª–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è.
  
### üìå **–ü—Ä–∏–º–µ—Ä**:
```js
db.collection.aggregate([
  {
    $unset: ["oldField1", "oldField2"]  // –£–¥–∞–ª—è–µ–º –ø–æ–ª—è `oldField1` –∏ `oldField2`
  }
])
```
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- –ü–æ–ª—è `oldField1` –∏ `oldField2` –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏.


